<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê°•í™”í•˜ê¸° v1.2</title>
    <style>
        :root { --bg: #1a1a2e; --panel: #16213e; --point: #e94560; --text: #ecf0f1; --money: #f1c40f; --mine: #2ecc71; --hunt: #3498db; --hp: #ff4d4d; }
        body { font-family: 'Malgun Gothic', sans-serif; text-align: center; background-color: var(--bg); color: var(--text); padding: 5px; margin: 0; }
        #game-container { background: var(--panel); max-width: 600px; margin: 0 auto; padding: 20px; border-radius: 15px; border: 2px solid var(--point); min-height: 95vh; box-sizing: border-box; }
        .page { display: none; } .page.active { display: block; }
        
        /* ìƒë‹¨ ê³ ì • ë°” */
        .top-bar { background: #0f3460; padding: 10px; border-radius: 12px; margin-bottom: 15px; display: grid; grid-template-columns: 1fr 1fr; gap: 5px; font-size: 0.9em; border-bottom: 2px solid var(--point); }
        .hp-bar-outer { grid-column: span 2; background: #333; height: 14px; border-radius: 7px; overflow: hidden; position: relative; border: 1px solid #000; margin-top: 5px; }
        #hp-fill { background: var(--hp); height: 100%; width: 100%; transition: 0.3s; }
        #hp-text { position: absolute; width: 100%; left: 0; top: 0; font-size: 0.75em; line-height: 14px; color: white; text-shadow: 1px 1px 2px black; }

        /* ë©”ì¸ ë©”ë‰´ ë²„íŠ¼ */
        .main-menu-btn { background: #533483; color: white; padding: 20px; margin: 10px 0; font-size: 1.2em; border-radius: 12px; cursor: pointer; border: 2px solid rgba(255,255,255,0.1); transition: 0.2s; }
        .main-menu-btn:hover { background: var(--point); transform: scale(1.02); }

        /* ì¸ë²¤í† ë¦¬ & ë¦¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ */
        .item-card { background: rgba(0,0,0,0.3); padding: 12px; border-radius: 10px; margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center; text-align: left; }
        .item-info { flex: 1; }
        .item-btn { width: 70px; padding: 8px; font-size: 0.8em; margin-left: 5px; }

        /* ê²©ì ìŠ¤íƒ€ì¼ */
        .grid-4 { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; margin: 15px 0; }
        .cell { aspect-ratio: 1/1; background: #0f3460; border-radius: 8px; display: flex; align-items: center; justify-content: center; cursor: pointer; font-size: 1.5em; border: 2px solid #1a1a2e; position: relative; }
        .monster-lv { position: absolute; bottom: 2px; right: 2px; font-size: 0.6em; background: rgba(0,0,0,0.8); padding: 2px; border-radius: 3px; }

        button { padding: 12px; cursor: pointer; border: none; border-radius: 8px; font-weight: bold; transition: 0.2s; width: 100%; }
        .btn-upgrade { background: var(--point); color: white; height: 55px; font-size: 1.1em; margin-bottom: 8px; }
        .btn-nav { background: #444; color: white; margin: 5px 0; }
        #log { height: 120px; overflow-y: auto; background: #1a1a2e; border-radius: 8px; padding: 10px; margin: 10px 0; font-size: 0.85em; text-align: left; color: #95a5a6; border: 1px solid #333; }
        
        .tab-menu { display: flex; gap: 5px; margin-bottom: 15px; }
        .tab-menu button { background: #333; color: #888; flex: 1; padding: 10px; }
        .tab-menu button.active { background: var(--point); color: white; }
    </style>
</head>
<body>

<div id="game-container">
    <div class="top-bar">
        <div>ğŸ’° <span id="gold">0</span>G</div>
        <div><img src="image/sworld_shard.png" style="width:14px; vertical-align:middle;"> <span id="shards">0</span></div>
        <div class="hp-bar-outer">
            <div id="hp-fill"></div>
            <div id="hp-text">HP <span id="hp-val">100</span> / 100</div>
        </div>
    </div>

    <div id="page-main" class="page active">
        <h1 style="color:var(--money); margin-bottom:30px;">ê°•í™”í•˜ê¸° v1.2</h1>
        <div class="main-menu-btn" onclick="showPage('page-earn')">ğŸ’° ê³¨ë“œ ë²Œê¸°<br><small>ì‚¬ëƒ¥í„° & ê´‘ì‚°</small></div>
        <div class="main-menu-btn" onclick="openUpgrade()">ğŸ”¨ ê°•í™” í•˜ê¸°<br><small>ì¥ë¹„ ê°•í™”</small></div>
        <div class="main-menu-btn" onclick="showPage('page-info')">ğŸ‘¤ ë‚´ ì •ë³´<br><small>ì¸ë²¤í† ë¦¬ & ìŠ¤í™</small></div>
        <div class="main-menu-btn" style="background:#222;" onclick="showPage('page-shop-select')">ğŸ›’ ìƒì </div>
    </div>

    <div id="page-earn" class="page">
        <h2>ğŸ’° ê³¨ë“œ ë²Œê¸°</h2>
        <button class="main-menu-btn" style="background:var(--hunt);" onclick="showPage('page-hunt')">âš”ï¸ ì‚¬ëƒ¥í„° ì…ì¥</button>
        <button class="main-menu-btn" style="background:var(--mine); color:black;" onclick="showPage('page-mine')">â›ï¸ ê´‘ì‚° ì…ì¥</button>
        <button class="btn-nav" onclick="showPage('page-main')">â¬…ï¸ ë’¤ë¡œê°€ê¸°</button>
    </div>

    <div id="page-info" class="page">
        <h2>ğŸ‘¤ ë‚´ ì •ë³´</h2>
        <div style="background:rgba(255,255,255,0.05); padding:15px; border-radius:12px; margin-bottom:15px; text-align:left;">
            <p>âš”ï¸ ê³µê²©ë ¥ (ATK): <span id="info-atk" style="color:var(--point);">0</span></p>
            <p>ğŸ›¡ï¸ ë°©ì–´ë ¥ (DEF): <span id="info-def" style="color:var(--hunt);">0</span></p>
            <p>âš¡ ê³µê²© ì†ë„: 1.0</p>
        </div>
        <h3>ğŸ’ ì¸ë²¤í† ë¦¬</h3>
        <div id="inventory-list"></div>
        <button class="btn-nav" onclick="showPage('page-main')">â¬…ï¸ ë’¤ë¡œê°€ê¸°</button>
    </div>

    <div id="page-upgrade" class="page">
        <h2>ğŸ”¨ ì¥ë¹„ ê°•í™”</h2>
        <div id="upgrade-target-box" class="item-card" style="background:var(--panel); border:1px solid var(--point);">
            ì„ íƒëœ ì•„ì´í…œì´ ì—†ìŠµë‹ˆë‹¤.
        </div>
        <div style="background:rgba(0,0,0,0.3); padding:10px; border-radius:10px; margin:10px 0; text-align:left; font-size:0.85em;">
            <h4 style="margin:0 0 8px 0; color:var(--money);">ğŸ›¡ï¸ ë°©ì§€ê¶Œ ì‚¬ìš©</h4>
            <label><input type="radio" name="prot" value="0" checked> ë¯¸ì‚¬ìš©</label><br>
            <label><input type="radio" name="prot" value="1"> í•˜ê¸‰ (<span id="inv-1">0</span>)</label>
            <label><input type="radio" name="prot" value="2"> ì¤‘ê¸‰ (<span id="inv-2">0</span>)</label>
            <label><input type="radio" name="prot" value="3"> ìƒê¸‰ (<span id="inv-3">0</span>)</label>
        </div>
        <div style="display:flex; justify-content:space-between; margin-bottom:10px; font-size:0.9em;">
            <span style="color:#4ecca3;">ì„±ê³µ <span id="up-chance">0</span>%</span>
            <span style="color:var(--point);">íŒŒê´´ <span id="up-break">0</span>%</span>
        </div>
        <button class="btn-upgrade" id="btn-up-exec" onclick="tryUpgrade()">ê°•í™”í•˜ê¸° (0G)</button>
        <button class="btn-nav" style="background:#3498db;" id="auto-btn" onclick="startAutoUpgrade()">ìë™ ê°•í™” (+10ê°•)</button>
        <div id="log">ì¸ë²¤í† ë¦¬ì—ì„œ ì•„ì´í…œì„ ì„ íƒí•´ ì£¼ì„¸ìš”.</div>
        <button class="btn-nav" onclick="showPage('page-main')">â¬…ï¸ ë©”ì¸ìœ¼ë¡œ</button>
    </div>

    <div id="page-shop-select" class="page">
        <h2>ğŸ›’ ìƒì </h2>
        <button class="main-menu-btn" style="background:#d35400;" onclick="showEquipShop()">âš”ï¸ ì¥ë¹„ ìƒì </button>
        <button class="main-menu-btn" style="background:#27ae60;" onclick="showItemShop()">ğŸ“œ ì†Œë¹„ ìƒì </button>
        <button class="btn-nav" onclick="showPage('page-main')">â¬…ï¸ ë’¤ë¡œê°€ê¸°</button>
    </div>

    <div id="page-shop-detail" class="page">
        <h2 id="shop-title">ìƒì </h2>
        <div id="shop-list"></div>
        <button class="btn-nav" onclick="showPage('page-shop-select')">â¬…ï¸ ë’¤ë¡œê°€ê¸°</button>
    </div>

    <div id="page-hunt" class="page">
        <h2 style="color:var(--hunt);">âš”ï¸ ì‚¬ëƒ¥í„°</h2>
        <div id="hunt-main">
            <button onclick="scanHunt()" style="background:var(--hunt); color:white; margin-bottom:10px;">ğŸ“¡ ëª¬ìŠ¤í„° íƒìƒ‰ (5,000G)</button>
            <div id="hunt-grid" class="grid-4" style="grid-template-columns: repeat(5, 1fr);"></div>
            <button class="btn-nav" onclick="showPage('page-earn')">â¬…ï¸ ë’¤ë¡œê°€ê¸°</button>
        </div>
        <div id="battle-screen" style="display:none; padding:20px; background:rgba(0,0,0,0.5); border-radius:12px;">
            <div id="battle-msg" style="margin-bottom:15px; font-weight:bold;">ì „íˆ¬ ê°œì‹œ!</div>
            <div style="display:flex; justify-content:space-between; font-size:1.2em;">
                <div>ë‚˜<br><span id="b-p-hp" style="color:var(--hp);">100</span></div>
                <div>VS</div>
                <div>ëª¬ìŠ¤í„°<br><span id="b-m-hp" style="color:var(--hp);">100</span></div>
            </div>
        </div>
    </div>

    <div id="page-mine" class="page">
        <h2 style="color:var(--mine);">â›ï¸ ê´‘ì‚°</h2>
        <div id="mine-grid" class="grid-4"></div>
        <button onclick="scanMine()" style="background:var(--mine); color:black;">ê´‘ì„ íƒìƒ‰ (1,000G)</button>
        <button class="btn-nav" onclick="showPage('page-earn')">â¬…ï¸ ë’¤ë¡œê°€ê¸°</button>
    </div>

</div>

<script>
    /* [v1.2 ë°ì´í„° êµ¬ì¡°] */
    let data = {
        gold: 100000, shards: 0, hp: 100,
        swordLv: 0, clothLv: 0,
        hasSword: true, hasCloth: true, // ì¥ë¹„ ë³´ìœ  ì—¬ë¶€
        inv: { item1: 0, item2: 0, item3: 0 },
        upgrading: 'none' // 'sword' or 'cloth'
    };

    let isAuto = false;
    let huntData = [], mineData = [];

    // ìŠ¤í™ ê³„ì‚° ê³µì‹
    const getAtk = lv => Math.floor(10 + (lv * 5) + Math.pow(lv, 2.5));
    const getDef = lv => Math.floor(2 + (lv * 2) + Math.pow(lv, 2.2));
    const getUpgradeCost = lv => Math.floor(10 * Math.pow(2.1, lv));

    function updateUI() {
        // [NaN ë°©ì§€]
        ['gold','shards','hp','swordLv','clothLv'].forEach(k => { if(isNaN(data[k])) data[k] = (k==='hp'?100:0); });
        
        document.getElementById('gold').innerText = Math.floor(data.gold).toLocaleString();
        document.getElementById('shards').innerText = data.shards;
        document.getElementById('hp-val').innerText = Math.floor(data.hp);
        document.getElementById('hp-fill').style.width = Math.max(0, data.hp) + '%';
        
        document.getElementById('info-atk').innerText = getAtk(data.swordLv);
        document.getElementById('info-def').innerText = getDef(data.clothLv);
        
        document.getElementById('inv-1').innerText = data.inv.item1;
        document.getElementById('inv-2').innerText = data.inv.item2;
        document.getElementById('inv-3').innerText = data.inv.item3;

        renderInventory();
    }

    /* ì¸ë²¤í† ë¦¬ ë Œë”ë§ */
    function renderInventory() {
        const list = document.getElementById('inventory-list');
        list.innerHTML = "";
        if(data.hasSword) {
            list.innerHTML += createItemCard("âš”ï¸ ê²€", data.swordLv, 'sword');
        }
        if(data.hasCloth) {
            list.innerHTML += createItemCard("ğŸ‘• ì²œ ì˜·", data.clothLv, 'cloth');
        }
        if(!data.hasSword && !data.hasCloth) list.innerHTML = "<p style='opacity:0.5;'>ë³´ìœ  ì¥ë¹„ ì—†ìŒ</p>";
    }

    function createItemCard(name, lv, type) {
        return `<div class="item-card">
            <div class="item-info"><strong>${name} +${lv}</strong><br><small>${type==='sword'?'ATK':'DEF'}: ${type==='sword'?getAtk(lv):getDef(lv)}</small></div>
            <button class="item-btn" style="background:#2980b9;" onclick="selectForUpgrade('${type}')">ê°•í™”</button>
            <button class="item-btn" style="background:#c0392b;" onclick="sellItem('${type}')">íŒë§¤</button>
        </div>`;
    }

    /* ê°•í™” ëŒ€ìƒ ì„ íƒ */
    function selectForUpgrade(type) {
        data.upgrading = type;
        showPage('page-upgrade');
        const lv = type === 'sword' ? data.swordLv : data.clothLv;
        const cost = getUpgradeCost(lv);
        const name = type === 'sword' ? 'âš”ï¸ ê²€' : 'ğŸ‘• ì²œ ì˜·';
        
        document.getElementById('upgrade-target-box').innerHTML = `<strong>${name} +${lv}</strong>`;
        document.getElementById('btn-up-exec').innerText = `ê°•í™”í•˜ê¸° (${cost.toLocaleString()}G)`;
        
        const sc = lv < 3 ? 100 : lv < 6 ? 85 : lv < 9 ? 60 : lv === 9 ? 50 : 40;
        const bc = lv >= 10 ? Math.min(50, 5 + (lv - 10) * 5) : 0;
        document.getElementById('up-chance').innerText = sc;
        document.getElementById('up-break').innerText = bc;
    }

    function openUpgrade() {
        data.upgrading = 'none';
        document.getElementById('upgrade-target-box').innerHTML = "ì¸ë²¤í† ë¦¬ì—ì„œ ì•„ì´í…œì„ ì„ íƒí•´ ì£¼ì„¸ìš”.";
        showPage('page-upgrade');
    }

    function tryUpgrade() {
        if(data.upgrading === 'none') { alert("ê°•í™”í•  ëŒ€ìƒì„ ì„ íƒí•˜ì„¸ìš”!"); return; }
        const type = data.upgrading;
        const lvKey = type === 'sword' ? 'swordLv' : 'clothLv';
        const cost = getUpgradeCost(data[lvKey]);
        
        if(data.gold < cost) { isAuto = false; addLog("ê³¨ë“œ ë¶€ì¡±!"); return; }

        const sel = document.querySelector('input[name="prot"]:checked').value;
        if (sel !== "0") {
            if(data.inv[`item${sel}`] > 0) data.inv[`item${sel}`]--;
            else { addLog("ë°©ì§€ê¶Œ ë¶€ì¡±!"); isAuto = false; return; }
        }

        data.gold -= cost;
        const sc = data[lvKey] < 3 ? 100 : data[lvKey] < 6 ? 85 : data[lvKey] < 9 ? 60 : data[lvKey] === 9 ? 50 : 40;
        const bc = data[lvKey] >= 10 ? Math.min(50, 5 + (lv - 10) * 5) : 0;

        if(Math.random()*100 < sc) {
            data[lvKey]++; addLog(`+${data[lvKey]} ê°•í™” ì„±ê³µ!`, "#4ecca3");
        } else {
            if(Math.random()*100 < bc && sel !== "3") {
                data[lvKey] = 0; 
                data[type === 'sword' ? 'hasSword' : 'hasCloth'] = false; // íŒŒê´´ ì‹œ ì†Œë©¸
                data.shards++; addLog("ì¥ë¹„ê°€ íŒŒê´´ë˜ì—ˆìŠµë‹ˆë‹¤!", "red"); isAuto = false;
                data.upgrading = 'none';
            } else {
                data[lvKey] = Math.max(0, data[lvKey]-1); addLog("ì‹¤íŒ¨(ë‹¨ê³„ í•˜ë½)");
            }
        }
        save(); selectForUpgrade(data.upgrading);
    }

    function startAutoUpgrade() {
        if(isAuto) { isAuto=false; return; }
        if(data.upgrading === 'none') return;
        isAuto = true;
        const itv = setInterval(() => {
            const lvKey = data.upgrading === 'sword' ? 'swordLv' : 'clothLv';
            if(!isAuto || data[lvKey] >= 10 || data.upgrading === 'none') { clearInterval(itv); isAuto=false; updateUI(); return; }
            tryUpgrade();
        }, 100);
    }

    /* ìƒì  ì‹œìŠ¤í…œ */
    function showEquipShop() {
        showPage('page-shop-detail');
        document.getElementById('shop-title').innerText = "âš”ï¸ ì¥ë¹„ ìƒì ";
        const list = document.getElementById('shop-list');
        list.innerHTML = `
            <div class="item-card"><span>âš”ï¸ ê²€ (1,000G)</span><button onclick="buyEquip('sword')" class="item-btn">êµ¬ë§¤</button></div>
            <div class="item-card"><span>ğŸ‘• ì²œ ì˜· (1,000G)</span><button onclick="buyEquip('cloth')" class="item-btn">êµ¬ë§¤</button></div>
        `;
    }
    function showItemShop() {
        showPage('page-shop-detail');
        document.getElementById('shop-title').innerText = "ğŸ“œ ì†Œë¹„ ìƒì ";
        const list = document.getElementById('shop-list');
        list.innerHTML = `
            <div class="item-card"><span>í•˜ê¸‰ ë°©ì§€ê¶Œ (10ë§ŒG)</span><button onclick="buyItem(1, 100000)" class="item-btn">êµ¬ë§¤</button></div>
            <div class="item-card"><span>ì¤‘ê¸‰ ë°©ì§€ê¶Œ (50ë§ŒG)</span><button onclick="buyItem(2, 500000)" class="item-btn">êµ¬ë§¤</button></div>
            <div class="item-card"><span>ìƒê¸‰ ë°©ì§€ê¶Œ (200ë§ŒG)</span><button onclick="buyItem(3, 2000000)" class="item-btn">êµ¬ë§¤</button></div>
        `;
    }
    function buyEquip(type) {
        if(data.gold < 1000) return alert("ê³¨ë“œ ë¶€ì¡±!");
        if(type === 'sword' && data.hasSword) return alert("ì´ë¯¸ ë³´ìœ  ì¤‘ì…ë‹ˆë‹¤.");
        if(type === 'cloth' && data.hasCloth) return alert("ì´ë¯¸ ë³´ìœ  ì¤‘ì…ë‹ˆë‹¤.");
        data.gold -= 1000;
        if(type === 'sword') { data.hasSword = true; data.swordLv = 0; }
        else { data.hasCloth = true; data.clothLv = 0; }
        alert("êµ¬ë§¤ ì™„ë£Œ!"); save();
    }
    function buyItem(t, p) {
        if(data.gold < p) return alert("ê³¨ë“œ ë¶€ì¡±!");
        data.gold -= p; data.inv[`item${t}`]++;
        alert("êµ¬ë§¤ ì™„ë£Œ!"); save();
    }
    function sellItem(type) {
        const lv = type === 'sword' ? data.swordLv : data.clothLv;
        const sp = Math.floor(getUpgradeCost(lv) * 0.4) + 500;
        data.gold += sp;
        if(type === 'sword') { data.hasSword = false; data.swordLv = 0; }
        else { data.hasCloth = false; data.clothLv = 0; }
        if(data.upgrading === type) data.upgrading = 'none';
        alert(`${sp.toLocaleString()}Gì— íŒë§¤í–ˆìŠµë‹ˆë‹¤.`); save();
    }

    /* ì‚¬ëƒ¥í„° & ê´‘ì‚° (í†µí•© ìœ ì§€) */
    function scanHunt() {
        if(!data.hasSword) return alert("ë¬´ê¸°ê°€ ì—†ìŠµë‹ˆë‹¤!");
        if(data.gold < 5000) return alert("ê³¨ë“œ ë¶€ì¡±!");
        data.gold -= 5000;
        huntData = [-2, -1, 0, 1, 2].map(d => ({ lv: Math.max(0, data.swordLv + d), diff: d, icon: ["ğŸ­","ğŸ","ğŸº","ğŸ—","ğŸ‘¹"][d+2] }));
        const g = document.getElementById('hunt-grid'); g.innerHTML = "";
        huntData.forEach(m => {
            const c = document.createElement('div'); c.className = "cell";
            c.innerHTML = `${m.icon}<span class="monster-lv">Lv.${m.lv}</span>`;
            c.onclick = () => startBattle(m); g.appendChild(c);
        });
        save();
    }
    function startBattle(m) {
        document.getElementById('hunt-main').style.display='none'; document.getElementById('battle-screen').style.display='block';
        let pAtk = getAtk(data.swordLv), pDef = getDef(data.clothLv), mAtk = getAtk(m.lv), mDef = getDef(m.lv)*0.4, mHP = 50+(m.lv*20);
        const bItv = setInterval(() => {
            let pDmg = Math.max(1, pAtk - mDef); mHP -= pDmg;
            document.getElementById('b-m-hp').innerText = Math.max(0, Math.floor(mHP));
            if(mHP <= 0) { clearInterval(bItv); data.gold += Math.floor(Math.pow(2, m.lv)*50); alert("ìŠ¹ë¦¬!"); finishBattle(); return; }
            setTimeout(() => {
                let mDmg = Math.max(1, mAtk - pDef); data.hp -= mDmg;
                document.getElementById('b-p-hp').innerText = Math.max(0, Math.floor(data.hp));
                if(data.hp <= 0) { clearInterval(bItv); data.hp=0; alert("íŒ¨ë°°!"); finishBattle(); }
            }, 300);
        }, 800);
    }
    function finishBattle() { document.getElementById('hunt-main').style.display='block'; document.getElementById('battle-screen').style.display='none'; huntData=[]; document.getElementById('hunt-grid').innerHTML=""; save(); }

    function scanMine() { 
        if(data.gold < 1000) return; data.gold -= 1000; 
        mineData = Array.from({length:16}, () => Math.random() > 0.8 ? {e:"ğŸ’", p:5000} : {e:"ğŸª¨", p:500});
        const g = document.getElementById('mine-grid'); g.innerHTML = "";
        mineData.forEach((ore, i) => {
            const c = document.createElement('div'); c.className = "cell";
            if(ore) { c.innerText = ore.e; c.onclick = () => { data.gold += ore.p; mineData[i]=null; renderMine(); save(); }; }
            g.appendChild(c);
        });
        save();
    }
    function renderMine() {
        const g = document.getElementById('mine-grid'); g.innerHTML = "";
        mineData.forEach((ore, i) => {
            const c = document.createElement('div'); c.className = "cell";
            if(ore) { c.innerText = ore.e; c.onclick = () => { data.gold += ore.p; mineData[i]=null; renderMine(); save(); }; }
            g.appendChild(c);
        });
    }

    /* ì‹œìŠ¤í…œ ë¡œì§ */
    function showPage(p) { document.querySelectorAll('.page').forEach(el => el.classList.remove('active')); document.getElementById(p).classList.add('active'); updateUI(); }
    function addLog(m, c) { const l = document.getElementById('log'); l.innerHTML = `<div style="color:${c || '#95a5a6'}">> ${m}</div>` + l.innerHTML; }
    function save() { localStorage.setItem('swordRPG_fixed', JSON.stringify(data)); updateUI(); }
    function load() {
        const s = localStorage.getItem('swordRPG_fixed');
        if(s) {
            const p = JSON.parse(s);
            data.gold = p.gold || 0; data.shards = p.shards || 0; data.hp = p.hp || 100;
            data.swordLv = p.swordLv || 0; data.clothLv = p.clothLv || 0;
            data.hasSword = p.hasSword !== undefined ? p.hasSword : true;
            data.hasCloth = p.hasCloth !== undefined ? p.hasCloth : true;
            data.inv = p.inv || { item1: 0, item2: 0, item3: 0 };
        }
        updateUI();
    }
    setInterval(() => { if(data.hp < 100) { data.hp = Math.min(100, data.hp + 1); updateUI(); } }, 2000);
    load();
</script>
</body>
</html>
